<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The STEM Gap</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&family=Source+Sans+3:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: #F7EDE2;
      --card: #ffffff;

      --btnA: #F5CAC3;
      --btnB: #F6BD60;

      --ink: #3B2F2A;
      --ink-soft: rgba(59,47,42,.78);
      --ink-muted: rgba(59,47,42,.62);

      --heading: #4A342E;
      --heading2: rgba(74,52,46,.78);

      --accent: #2E5466;
      --accent2:#7C3A2D;

      --hairline: rgba(59,47,42,.14);
      --r: 16px;
      --shadow: 0 14px 40px rgba(59,47,42,.14);

      --sidebar-w: 140px;
      --note-w: 320px;
      --max: 1200px;
      --gap: 18px;
    }

    *{ box-sizing:border-box; }
    html{ scroll-behavior:smooth; }

    body{
      margin:0;
      font-family: "Source Sans 3", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--ink);
      overflow-x:hidden;
    }

    .bg{
      position: fixed;
      inset: 0;
      z-index: -1;
      background:
        radial-gradient(1200px 600px at 50% 15%, rgba(255,255,255,.60), transparent 65%),
        radial-gradient(900px 700px at 80% 30%, rgba(245,202,195,.20), transparent 72%),
        radial-gradient(860px 700px at 50% 95%, rgba(246,189,96,.15), transparent 75%);
    }

    /* ========== SNAP CONTAINER ========== */
    .snap{
      height: 100vh;
      overflow-y: auto;
      scroll-snap-type: y mandatory;
    }
    .page{
      min-height: 100vh;
      scroll-snap-align: start;
    }

    /* PAGE 1 — HERO */
    .hero-page{
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 80px 24px;
      text-align:center;
    }
    .hero{
      max-width: 1200px;
      width:100%;
    }
    .kicker{
      display:inline-flex;
      align-items:center;
      gap: 10px;
      font-family: "Libre Baskerville", serif;
      font-size: 13px;
      letter-spacing: .22em;
      text-transform: uppercase;
      color: var(--ink-muted);
      margin-bottom: 40px;
    }
    .kicker::before{
      content:"";
      width:10px;
      height:10px;
      border-radius:50%;
      background: var(--accent2);
      box-shadow: 0 0 0 4px rgba(255,255,255,.62);
    }

    .title{
      font-family: "Libre Baskerville", serif;
      font-weight: 700;
      font-size: 84px;
      line-height: 1.18;
      letter-spacing: .3px;
      margin: 0 0 56px;
      color: var(--heading);
    }
    .nowrap{ white-space: nowrap; }

    .deck{
      font-family: "Libre Baskerville", serif;
      font-style: italic;
      font-size: 20px;
      line-height: 2.15;
      color: var(--ink-soft);
      max-width: 820px;
      margin: 0 auto 48px;
    }

    .meta{
      display:flex;
      justify-content:center;
      flex-wrap:wrap;
      gap: 16px 26px;
      font-size: 14px;
      color: var(--ink-muted);
      margin-bottom: 56px;
    }
    .meta span::before{
      content:"•";
      margin-right: 10px;
      opacity: .45;
    }

    .actions{
      display:flex;
      justify-content:center;
      gap: 18px;
      margin-bottom: 40px;
      flex-wrap: wrap;
    }
    .btn{
      border: 1px solid rgba(59,47,42,.16);
      padding: 14px 24px;
      border-radius: 999px;
      font-size: 15px;
      font-weight: 650;
      cursor:pointer;
      box-shadow: 0 10px 22px rgba(59,47,42,.10);
      color: rgba(59,47,42,.82);
    }
    .btn.primary{ background: var(--btnB); }
    .btn.secondary{ background: var(--btnA); }

    .scrollhint{
      display:inline-flex;
      align-items:center;
      gap: 12px;
      font-size: 14px;
      color: var(--ink-muted);
    }
    .scrollhint span{
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: 1px solid rgba(59,47,42,.18);
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(255,255,255,.72);
    }

    /* PAGE 2 — OUTLET CONTENT */
    .content-page{
      display:flex;
      justify-content:center;
      padding: 20px 0 60px;
    }

    /* wrap：左侧目录 + 主内容 */
    .wrap{
      width: min(var(--max), 100%);
      padding: 0 20px;
      display:grid;
      grid-template-columns: var(--sidebar-w) 1fr;
      gap: var(--gap);
      align-items:start;
    }

    /* LEFT — CONTENTS */
    .side{
      position: sticky;
      top: 20px;
      background: rgba(255,255,255,.60);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      padding: 10px 8px;
      border: 1px solid rgba(59,47,42,.08);
      height: fit-content;
    }
    .side h3{
      font-family: "Libre Baskerville", serif;
      font-size: 14px;
      margin: 6px 8px 12px;
      color: var(--heading2);
    }
    .nav{
      display:flex;
      flex-direction:column;
      gap: 6px;
    }
    .nav a{
      display:flex;
      align-items:center;
      gap: 8px;
      padding: 8px;
      border-radius: 12px;
      text-decoration:none;
      font-size: 12.5px;
      color: rgba(59,47,42,.82);
    }
    .nav a.active{
      background:#fff;
      box-shadow: 0 6px 16px rgba(59,47,42,.10);
      font-weight: 700;
      color: rgba(59,47,42,.92);
    }
    .dot{
      width: 8px;
      height: 8px;
      border-radius: 50%;
      border: 2px solid rgba(46,84,102,.55);
    }
    .nav a.active .dot{
      background: var(--accent);
      border-color: var(--accent);
    }

    /* CENTER — STACK */
    .center{
      display:flex;
      flex-direction:column;
      gap: 20px;
      min-width: 0;
    }

    /* CARD base */
    .card{
      background:#fff;
      border-radius: var(--r);
      box-shadow: var(--shadow);
      padding: 18px 18px 16px;
      border: 1px solid rgba(59,47,42,.06);
      scroll-margin-top: 20px;
      position: relative;
      z-index: 1;
      min-width: 0;
    }
    .card h2{
      margin: 0 0 10px;
      font-size: 17px;
      font-weight: 800;
      color: var(--heading);
      letter-spacing: .1px;
    }

    /* INTRO card */
    .intro-text{
      max-width: 860px;
      padding: 16px 18px;
      background: rgba(245,202,195,.22);
      border-left: 4px solid rgba(124,58,45,.38);
      border-radius: 10px;
    }
    .intro-text p{
      margin: 0 0 12px;
      font-size: 15.5px;
      line-height: 1.85;
      color: rgba(59,47,42,.78);
    }
    .intro-text p:last-child{ margin-bottom: 0; }

    /* ✅ list inside intro-text (for takeaways) */
    .intro-text ul{
      margin: 0;
      padding-left: 18px;
    }
    .intro-text li{
      margin: 0 0 10px;
      font-size: 15.5px;
      line-height: 1.85;
      color: rgba(59,47,42,.78);
    }
    .intro-text li:last-child{ margin-bottom: 0; }

    /* ✅ links inside intro-text */
    .intro-text a{
      color: rgba(46,84,102,.92);
      text-decoration: underline;
      text-underline-offset: 2px;
    }

    /* Pair layout: chart + note */
    .card-with-note{
      /* ✅ 每个 section 可自定义这两个变量 */
      --vizH: 680px;     /* chart 容器高度 */
      --noteH: 680px;    /* note 容器高度（和图一致） */

      display: grid;
      grid-template-columns: 1fr var(--note-w);
      gap: var(--gap);
      align-items: start;
    }
    .card-with-note .card{ margin: 0; }

    /* Viz container */
    .viz{
      border-radius: 12px;
      background: rgba(247,237,226,.20);
      overflow: hidden;
      padding: 8px 8px 4px;
      min-height: var(--vizH);  /* ✅ 用变量控制，和 note 对齐 */
      width: 100%;
      max-width: 100%;
    }
    .viz .vega-embed,
    .viz .vega-embed > div{
      width: 100% !important;
      max-width: 100% !important;
    }
    .viz .vega-embed svg,
    .viz .vega-embed canvas{
      width: 100% !important;
      height: auto !important;
      display: block;
    }
    .viz .vega-embed summary{ display:none; }

    /* Note */
    .note{
      background: #ffffff;
      border-radius: var(--r);
      box-shadow: var(--shadow);
      padding: 14px;
      border: 1px solid rgba(59,47,42,.08);
      min-width: 0;
    }

    /* ✅ 统一成 “global note” 的 sticky + 自滚动表现 */
    .card-with-note .note{
      position: sticky;
      top: 20px;
      align-self: start;

      height: var(--noteH);      /* ✅ 关键：每个 card 自己的 note 高度 */
      max-height: var(--noteH);  /* ✅ 不再用 viewport 算法（避免所有 note 看起来一样） */
      overflow: hidden;
      z-index: 5;
    }

    .note h4{
      margin: 0 0 8px;
      font-size: 13px;
      letter-spacing: .14em;
      text-transform: uppercase;
      color: rgba(59,47,42,.55);
      font-weight: 700;
    }
    .note p{
      margin: 0 0 12px;
      font-size: 15.5px;
      line-height: 1.85;
      color: rgba(59,47,42,.78);
    }
    .note p:last-child{ margin-bottom: 0; }

    /* ✅ note 内容可滚动（Global 那种） */
    .note.note-scroll{
      overflow-y: auto;
      padding-right: 10px;
      -webkit-overflow-scrolling: touch;
    }

    @media (max-width: 1000px){
      .title{ font-size: 64px; line-height: 1.16; }
      .deck{ font-size: 18px; line-height: 2.05; }

      .wrap{ grid-template-columns: 1fr; }
      .side{ position: relative; top: 0; }

      .card-with-note{ grid-template-columns: 1fr; }
      .card-with-note .note{
        display: none;
        position: relative;
        top: 0;
        height: auto;
        max-height: none;
      }
    }

    @media (max-width:600px){
      .title{ font-size: 46px; line-height: 1.14; }
      .deck{ font-size: 16px; }
    }
  </style>

  <!-- Vega / Vega-Lite / Embed -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>

<body>
<div class="bg"></div>

<div class="snap" id="snap">

  <!-- PAGE 1 -->
  <section class="page hero-page" id="top">
    <div class="hero">
      <div class="kicker">SI 649 · Narrative / Data Journalism</div>

      <h1 class="title">
        The STEM Gap:<br>
        What’s Changing — and<br>
        <span class="nowrap">What Isn’t</span>
      </h1>

      <p class="deck">
        A data-driven look at how women’s presence in science, technology,
        engineering, and mathematics has grown, where progress has stalled,
        and why the gap still persists.
      </p>

      <div class="meta">
        <span>Global comparisons</span>
        <span>Trends over time</span>
        <span>By-field breakdown</span>
        <span>Takeaways + limitations</span>
      </div>

      <div class="actions">
        <button class="btn primary"
          onclick="document.getElementById('content').scrollIntoView({behavior:'smooth'})">
          Start reading
        </button>
        <button class="btn secondary"
          onclick="document.getElementById('global').scrollIntoView({behavior:'smooth'})">
          Jump to Global
        </button>
      </div>

      <div class="scrollhint">
        <span>↓</span> Scroll to enter the story
      </div>
    </div>
  </section>

  <!-- PAGE 2 -->
  <section class="page content-page" id="content">
    <div class="wrap">

      <!-- LEFT -->
      <aside class="side">
        <h3>Contents</h3>
        <nav class="nav" id="nav">
          <a class="active" href="#intro"><span class="dot"></span>Intro</a>
          <a href="#global"><span class="dot"></span>Global overview</a>
          <a href="#trend"><span class="dot"></span>Trends</a>
          <a href="#field"><span class="dot"></span>By field</a>
          <a href="#takeaways"><span class="dot"></span>Takeaways</a>
          <a href="#sources"><span class="dot"></span>Sources</a>
        </nav>
      </aside>

      <!-- CENTER -->
      <main class="center" id="center">

        <!-- Intro -->
        <section class="card" id="intro">
          <h2>Introduction</h2>
          <div class="intro-text">
            <p>
              Over the past few decades, women’s participation in higher education has increased
              dramatically in many parts of the world. In several countries, women now earn
              degrees at rates comparable to—or higher than—men.
            </p>
            <p>
              Yet this overall progress masks a more uneven reality. In science, technology,
              engineering, and mathematics (STEM), women remain underrepresented, and the pace
              of change varies widely across countries and fields.
            </p>
            <p>
              This project examines how women’s share of STEM graduates has changed over time,
              where progress has accelerated, and where it has stalled.
            </p>
          </div>
        </section>

        <!-- Global overview -->
        <!-- ✅ big pair height -->
        <section class="card-with-note" id="global" style="--vizH: 680px; --noteH: 680px;">
          <section class="card">
            <h2>Global overview</h2>
            <div id="globalview" class="viz"></div>
          </section>

          <aside class="note note-scroll">
            <h4>What to notice</h4>

            <p>
              Drawing on prior research in education and labor economics, cross-country differences
              in women’s participation in STEM are often shaped by cultural norms, educational systems,
              and policy environments rather than economic development alone. With this broader context
              in mind, looking at the most recent year available allows us to compare how women’s share
              of STEM graduates varies across countries.
            </p>

            <p>
              At a global level, women’s representation ranges widely, from close to 0% in some regions
              to nearly 70% in others. <strong>However, the distribution is heavily skewed toward the
              lower end: 92.8% of all data points fall below 50%</strong>, meaning that in the overwhelming
              majority of countries, women make up less than half of STEM degree recipients.
              <strong>This highlights that gender parity in STEM remains the exception rather than the norm
              worldwide</strong>.
            </p>

            <p>
              Geographically, countries with the highest female STEM representation are not clustered
              in traditionally expected regions such as Europe or North America. Instead, many of the
              top performers—including Samoa, Myanmar, Tunisia, and several Middle Eastern and African
              economies—<strong>are concentrated in Africa and parts of Asia</strong>.
              <strong>This pattern challenges the common assumption—often reflected in public and policy
              discussions—that economic development or a Western context alone predicts greater gender
              equity in STEM</strong>.
            </p>
          </aside>
        </section>

        <!-- Trends -->
        <!-- ✅ big pair height -->
        <section class="card-with-note" id="trend" style="--vizH: 680px; --noteH: 680px;">
          <section class="card">
            <h2>Trends over time</h2>
            <div id="trendview" class="viz"></div>
          </section>

          <aside class="note note-scroll">
            <h4>What to notice</h4>

            <p>
              To explore these patterns in greater depth, we focus on six major countries—Australia,
              Canada, China, Germany, India, and the United States—and examine how women’s participation
              in STEM has evolved over the past two decades.
            </p>

            <p>
              <strong>Female STEM enrollment remains persistently below parity across all six countries.</strong>
              Enrollment levels fluctuate over time, but none of the countries consistently reaches
              50 percent. The United States, Germany, China, and Australia show relatively stable trends,
              while India exhibits larger year-to-year variation. Using the year slider highlights
              shifting rankings in specific years—for example, in 2016 the United States ranks highest,
              while Canada ranks lowest—yet overall progress remains limited.
            </p>

            <p>
              <strong>By contrast, female STEM graduation rates show a clearer upward trend.</strong>
              Most countries gradually increase women’s share of STEM graduates over time, with the
              strongest gains observed in China and the United States. This divergence suggests that,
              although fewer women may be entering STEM programs, those who do enroll are increasingly
              likely to complete their degrees.
            </p>

            <p>
              <strong>Finally, the Gender Gap Index indicates modest but incomplete progress toward parity.</strong>
              Across the six countries, GGI values remain within a relatively narrow range, with Germany,
              India, and China generally showing higher parity, and Australia consistently lagging behind.
              Overall, the trends point to incremental improvement rather than a decisive shift toward full
              gender equality in STEM.
            </p>
          </aside>
        </section>

        <!-- By field (heatmap.json) -->
        <!-- ✅ compact pair height -->
        <section class="card-with-note" id="field" style="--vizH: 480px; --noteH: 480px;">
          <section class="card">
            <h2>By field</h2>
            <div id="heatmapview" class="viz"></div>
          </section>

          <aside class="note note-scroll">
            <h4>What to notice</h4>

            <p>
              Across all six countries, women’s enrollment in STEM shows <strong>little sustained progress from 2000 to 2023</strong>.
              Although year-to-year fluctuations are common, long-term upward trends are rare. Short-lived increases in certain years
              or fields tend to fade rather than accumulate into lasting change.
            </p>

            <p>
              <strong>Differences across fields are more consistent than differences across countries.</strong>
              Biology consistently attracts a higher share of women, while <strong>engineering and computer science remain the most
              male-dominated fields</strong> in every country. Mathematics typically falls in between, with moderate but unstable
              female representation.
            </p>

            <p>
              National patterns differ mainly in <strong>volatility, not direction</strong>. India and China exhibit larger year-to-year
              swings, whereas the United States, Canada, Germany, and Australia appear more stable. Yet in all six countries, women’s
              enrollment rarely approaches parity, and <strong>no country shows a clear, sustained breakthrough</strong>.
            </p>

            <p>
              Taken together, the data suggest that <strong>gender gaps in STEM are already entrenched at the point of entry</strong>.
              Two decades of enrollment data reveal fluctuation without transformation, underscoring how field-level structures continue
              to shape who enters STEM in the first place.
            </p>
          </aside>
        </section>

        <!-- Takeaways -->
        <section class="card" id="takeaways">
          <h2>Takeaways</h2>
          <div class="intro-text">
            <p style="margin-top:0; font-weight:700; letter-spacing:.14em; text-transform:uppercase; color: rgba(59,47,42,.55); font-size:13px;">
              Key takeaways
            </p>
            <ul>
              <li>
                Two decades of data show <strong>fluctuation without transformation</strong> in women’s STEM enrollment
                across all six countries.
              </li>
              <li>
                <strong>What women study matters more than where they study</strong>:
                field-level patterns dominate national differences.
              </li>
              <li>
                Improvements in graduation rates without parallel gains in enrollment point to
                <strong>persistent barriers at entry</strong>, rather than during degree completion.
              </li>
            </ul>
          </div>
        </section>

        <!-- Sources -->
        <section class="card" id="sources">
          <h2>Sources</h2>
          <div class="intro-text">
            <p style="margin-top:0; font-weight:700; letter-spacing:.14em; text-transform:uppercase; color: rgba(59,47,42,.55); font-size:13px;">
              Data sources
            </p>

            <p>
              World Bank Gender Data Portal:
              <a href="https://genderdata.worldbank.org/en/indicator/se-ter-grad-fe-zs?fieldOfStudy=Science%2C+Technology%2C+Engineering+and+Mathematics+%28STEM%29" target="_blank" rel="noopener">
                Female share of graduates from STEM programmes, tertiary (%)
              </a>
            </p>

            <p>
              Kaggle:
              <a href="https://www.kaggle.com/datasets/bismasajjad/womens-representation-in-global-stem-education" target="_blank" rel="noopener">
                Women’s representation in global STEM education
              </a>
            </p>

            <p style="margin-bottom:0;">
              <strong>Any questions?</strong> Email me at <strong>xvming@umich.edu</strong>.
            </p>
          </div>
        </section>

      </main>

    </div>
  </section>

</div>

<script>
  async function embedGlobalView(){
    await vegaEmbed("#globalview", "globalview.json", {
      actions: false,
      renderer: "svg"
    });
  }

  async function embedTrendView(){
    await vegaEmbed("#trendview", "lineplot.json", {
      actions: false,
      renderer: "svg"
    });
  }

  async function embedHeatmapView(){
    await vegaEmbed("#heatmapview", "heatmap.json", {
      actions: false,
      renderer: "svg"
    });
  }

  embedGlobalView();
  embedTrendView();
  embedHeatmapView();

  // Scroll spy for nav (root is snap container)
  const snap = document.getElementById("snap");
  const navLinks = [...document.querySelectorAll("#nav a")];
  const sections = navLinks
    .map(a => document.querySelector(a.getAttribute("href")))
    .filter(Boolean);

  const spy = new IntersectionObserver((entries) => {
    const visible = entries
      .filter(e => e.isIntersecting)
      .sort((a,b)=>b.intersectionRatio-a.intersectionRatio)[0];
    if(!visible) return;

    navLinks.forEach(a =>
      a.classList.toggle("active", a.getAttribute("href") === "#" + visible.target.id)
    );
  }, { root: snap, threshold: [0.45, 0.65] });

  sections.forEach(s => spy.observe(s));
</script>

</body>
</html>
